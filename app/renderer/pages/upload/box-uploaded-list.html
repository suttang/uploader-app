<dom-module id="box-uploaded-list">

  <template>
    <style>
      :host {
        display: block;
        background: #f6f6f6;
        border-right: 1px solid #d1d1d1;
      }
      h1 {
        margin: 0 0 10px 0;
        padding: 0;
        line-height: 1;
        font-size: 9px;
        font-weight: 500;
      }
      ul {
        margin: 0;
        padding: 10px;
        list-style: none;
      }
      ul > li {
        font-size: 12px;
      }
    </style>

    <ul>
      <h1>UPLOADS</h1>
      <template is="dom-repeat" items="{{uploads}}">
        <li>{{item.name}}</li>
      </template>
    </ul>

  </template>

  <script>

    Polymer({
      is: 'box-uploaded-list',
      properties: {
        uploads: {
          type: Array,
          value: function() {
            return [];
          }
        }
      },
      ready() {
        setTimeout(() => {
          const uuid = firebase.auth().currentUser.uid;
          const uploadsRef = firebase.database().ref(`uploads/${uuid}`);
          uploadsRef.on('value', (snapshot) => {
            this.refresh(snapshot.val());
          });
        }, 1000);
      },
      refresh(entries) {
        console.log("ON REFRESH");
        for (let key in entries) {
          let entry = entries[key];
          this.push('uploads', entry);
        }
      },
    });

  </script>

</dom-module>
